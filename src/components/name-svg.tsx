import { FC, useEffect, useRef } from "react";
import {
  useSpring,
  useTransform,
  useViewportScroll,
  motion,
} from "framer-motion";
import anime from "animejs";
import styled from "styled-components";

export const NameSvg: FC = () => {
  const svgRef = useRef(null);
  const progress = useTransform(useViewportScroll()["scrollY"], (y) =>
    y > 500 ? 1 : 0
  );

  const strokeWidth = useSpring(
    useTransform(progress, (p) => (p === 0 ? 2 : 1)),
    { damping: 40, mass: 0.2 }
  );
  const widthNum = useSpring(
    useTransform(progress, (p) => (p === 0 ? 30 : 15)),
    { damping: 40, mass: 0.2 }
  );
  const width = useTransform(widthNum, (w) => `${w}vw`);

  useEffect(() => {
    const timeline = anime.timeline();
    timeline.add({
      targets: svgRef.current?.children,
      strokeDashoffset: [anime.setDashoffset, 0],
      easing: "easeInOutSine",
      duration: 800,
      delay: function (el, i) {
        return i * 100;
      },
    });
  }, []);

  return (
    <Container>
      <motion.svg ref={svgRef} style={{ width }} viewBox="0 0 333.04 180">
        <motion.path
          fill="#080708"
          stroke="#fff"
          strokeWidth={strokeWidth}
          d="M5.04 69.70L5.04 19.30L28.87 19.30Q37.15 19.30 43.56 22.39Q49.97 25.49 53.50 31.18Q57.02 36.86 57.02 44.50L57.02 44.50Q57.02 52.13 53.50 57.82Q49.97 63.50 43.56 66.60Q37.15 69.70 28.87 69.70L28.87 69.70L5.04 69.70ZM19.30 58.32L28.30 58.32Q34.78 58.32 38.70 54.65Q42.62 50.98 42.62 44.50L42.62 44.50Q42.62 38.02 38.70 34.34Q34.78 30.67 28.30 30.67L28.30 30.67L19.30 30.67L19.30 58.32Z"
        />
        <motion.path
          fill="#080708"
          stroke="#fff"
          strokeWidth={strokeWidth}
          d="M75.50 30.02Q85.22 30.02 90.33 34.45Q95.44 38.88 95.44 48.02L95.44 48.02L95.44 69.70L82.70 69.70L82.70 64.66Q79.74 70.34 71.18 70.34L71.18 70.34Q66.64 70.34 63.33 68.76Q60.02 67.18 58.32 64.48Q56.63 61.78 56.63 58.32L56.63 58.32Q56.63 52.78 60.88 49.72Q65.13 46.66 73.98 46.66L73.98 46.66L81.76 46.66Q81.40 40.46 73.48 40.46L73.48 40.46Q70.67 40.46 67.79 41.36Q64.91 42.26 62.90 43.85L62.90 43.85L58.29 34.56Q61.53 32.40 66.17 31.21Q70.82 30.02 75.50 30.02L75.50 30.02ZM74.99 61.70Q77.37 61.70 79.17 60.55Q80.97 59.40 81.76 57.17L81.76 57.17L81.76 53.78L75.86 53.78Q69.88 53.78 69.88 57.74L69.88 57.74Q69.88 59.54 71.25 60.62Q72.62 61.70 74.99 61.70L74.99 61.70Z"
        />
        <motion.path
          fill="#080708"
          stroke="#fff"
          strokeWidth={strokeWidth}
          d="M127.16 30.67L140.19 30.67L124.06 69.70L109.95 69.70L93.90 30.67L107.94 30.67L117.30 54.50L127.16 30.67Z"
        />
        <motion.path
          fill="#080708"
          stroke="#fff"
          strokeWidth={strokeWidth}
          d="M138.72 69.70L138.72 30.67L152.40 30.67L152.40 69.70L138.72 69.70ZM145.56 26.35Q141.82 26.35 139.51 24.26Q137.21 22.18 137.21 19.08L137.21 19.08Q137.21 15.98 139.51 13.90Q141.82 11.81 145.56 11.81L145.56 11.81Q149.30 11.81 151.61 13.79Q153.91 15.77 153.91 18.86L153.91 18.86Q153.91 22.10 151.61 24.23Q149.30 26.35 145.56 26.35L145.56 26.35Z"
        />
        <motion.path
          fill="#080708"
          stroke="#fff"
          strokeWidth={strokeWidth}
          d="M184.05 16.27L197.73 16.27L197.73 69.70L184.70 69.70L184.70 65.81Q180.88 70.34 173.25 70.34L173.25 70.34Q167.92 70.34 163.53 67.86Q159.14 65.38 156.58 60.77Q154.02 56.16 154.02 50.11L154.02 50.11Q154.02 44.06 156.58 39.49Q159.14 34.92 163.53 32.47Q167.92 30.02 173.25 30.02L173.25 30.02Q180.23 30.02 184.05 34.06L184.05 34.06L184.05 16.27ZM176.13 59.47Q179.66 59.47 181.96 56.99Q184.26 54.50 184.26 50.11L184.26 50.11Q184.26 45.79 182.00 43.34Q179.73 40.90 176.13 40.90L176.13 40.90Q172.53 40.90 170.22 43.34Q167.92 45.79 167.92 50.11L167.92 50.11Q167.92 54.50 170.22 56.99Q172.53 59.47 176.13 59.47L176.13 59.47Z"
        />
        <motion.path
          fill="#080708"
          stroke="#fff"
          strokeWidth={strokeWidth}
          d="M63.65 149.70L50.54 149.70L50.40 122.98L37.44 144.73L31.10 144.73L18.22 123.70L18.22 149.70L5.04 149.70L5.04 99.30L16.78 99.30L34.49 128.38L51.77 99.30L63.50 99.30L63.65 149.70Z"
        />
        <motion.path
          fill="#080708"
          stroke="#fff"
          strokeWidth={strokeWidth}
          d="M83.02 150.34Q76.54 150.34 71.43 147.75Q66.32 145.16 63.48 140.55Q60.63 135.94 60.63 130.11L60.63 130.11Q60.63 124.28 63.48 119.71Q66.32 115.14 71.43 112.58Q76.54 110.02 83.02 110.02L83.02 110.02Q89.65 110.02 94.47 112.87Q99.30 115.71 101.31 120.75L101.31 120.75L90.73 126.15Q88.06 120.90 82.95 120.90L82.95 120.90Q79.28 120.90 76.87 123.34Q74.46 125.79 74.46 130.11L74.46 130.11Q74.46 134.50 76.87 136.99Q79.28 139.47 82.95 139.47L82.95 139.47Q88.06 139.47 90.73 134.22L90.73 134.22L101.31 139.62Q99.30 144.66 94.47 147.50Q89.65 150.34 83.02 150.34L83.02 150.34Z"
        />
        <motion.path
          fill="#080708"
          stroke="#fff"
          strokeWidth={strokeWidth}
          d="M131.13 99.30L145.10 99.30L145.10 149.70L133.36 149.70L111.11 122.84L111.11 149.70L97.14 149.70L97.14 99.30L108.88 99.30L131.13 126.15L131.13 99.30Z"
        />
        <motion.path
          fill="#080708"
          stroke="#fff"
          strokeWidth={strokeWidth}
          d="M161.16 110.02Q170.88 110.02 175.99 114.45Q181.10 118.88 181.10 128.02L181.10 128.02L181.10 149.70L168.36 149.70L168.36 144.66Q165.41 150.34 156.84 150.34L156.84 150.34Q152.30 150.34 148.99 148.76Q145.68 147.18 143.99 144.48Q142.30 141.78 142.30 138.32L142.30 138.32Q142.30 132.78 146.54 129.72Q150.79 126.66 159.65 126.66L159.65 126.66L167.42 126.66Q167.06 120.46 159.14 120.46L159.14 120.46Q156.34 120.46 153.46 121.36Q150.58 122.26 148.56 123.85L148.56 123.85L143.95 114.56Q147.19 112.40 151.84 111.21Q156.48 110.02 161.16 110.02L161.16 110.02ZM160.66 141.70Q163.03 141.70 164.83 140.55Q166.63 139.40 167.42 137.17L167.42 137.17L167.42 133.78L161.52 133.78Q155.54 133.78 155.54 137.74L155.54 137.74Q155.54 139.54 156.91 140.62Q158.28 141.70 160.66 141.70L160.66 141.70Z"
        />
        <motion.path
          fill="#080708"
          stroke="#fff"
          strokeWidth={strokeWidth}
          d="M230.58 110.02Q237.78 110.02 242.06 114.34Q246.34 118.66 246.34 127.38L246.34 127.38L246.34 149.70L232.66 149.70L232.66 129.61Q232.66 125.50 231.12 123.56Q229.57 121.62 226.76 121.62L226.76 121.62Q223.66 121.62 221.79 123.78Q219.92 125.94 219.92 130.33L219.92 130.33L219.92 149.70L206.24 149.70L206.24 129.61Q206.24 121.62 200.34 121.62L200.34 121.62Q197.17 121.62 195.30 123.78Q193.42 125.94 193.42 130.33L193.42 130.33L193.42 149.70L179.74 149.70L179.74 110.67L192.78 110.67L192.78 114.78Q194.94 112.40 197.92 111.21Q200.91 110.02 204.44 110.02L204.44 110.02Q208.54 110.02 211.78 111.54Q215.02 113.05 217.04 116.14L217.04 116.14Q219.34 113.19 222.87 111.61Q226.40 110.02 230.58 110.02L230.58 110.02Z"
        />
        <motion.path
          fill="#080708"
          stroke="#fff"
          strokeWidth={strokeWidth}
          d="M284.87 130.26Q284.87 130.40 284.66 133.64L284.66 133.64L256.29 133.64Q257.15 136.66 259.64 138.28Q262.12 139.90 265.86 139.90L265.86 139.90Q268.67 139.90 270.72 139.11Q272.78 138.32 274.86 136.52L274.86 136.52L282.06 144.01Q276.38 150.34 265.43 150.34L265.43 150.34Q258.59 150.34 253.41 147.75Q248.22 145.16 245.38 140.55Q242.54 135.94 242.54 130.11L242.54 130.11Q242.54 124.35 245.31 119.78Q248.08 115.21 252.98 112.62Q257.87 110.02 263.99 110.02L263.99 110.02Q269.82 110.02 274.58 112.44Q279.33 114.85 282.10 119.42Q284.87 123.99 284.87 130.26L284.87 130.26ZM264.06 119.74Q260.90 119.74 258.77 121.54Q256.65 123.34 256.07 126.44L256.07 126.44L272.06 126.44Q271.48 123.34 269.36 121.54Q267.23 119.74 264.06 119.74L264.06 119.74Z"
        />
        <motion.path
          fill="#080708"
          stroke="#fff"
          strokeWidth={strokeWidth}
          d="M321.10 130.26Q321.10 130.40 320.88 133.64L320.88 133.64L292.51 133.64Q293.38 136.66 295.86 138.28Q298.34 139.90 302.09 139.90L302.09 139.90Q304.90 139.90 306.95 139.11Q309.00 138.32 311.09 136.52L311.09 136.52L318.29 144.01Q312.60 150.34 301.66 150.34L301.66 150.34Q294.82 150.34 289.63 147.75Q284.45 145.16 281.60 140.55Q278.76 135.94 278.76 130.11L278.76 130.11Q278.76 124.35 281.53 119.78Q284.30 115.21 289.20 112.62Q294.10 110.02 300.22 110.02L300.22 110.02Q306.05 110.02 310.80 112.44Q315.55 114.85 318.32 119.42Q321.10 123.99 321.10 130.26L321.10 130.26ZM300.29 119.74Q297.12 119.74 295.00 121.54Q292.87 123.34 292.30 126.44L292.30 126.44L308.28 126.44Q307.70 123.34 305.58 121.54Q303.46 119.74 300.29 119.74L300.29 119.74Z"
        />
      </motion.svg>
    </Container>
  );
};

const Container = styled(motion.div)`
  display: block;
  position: fixed;
  bottom: 0;
  left: 1em;
  z-index: 100;
`;
